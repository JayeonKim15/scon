<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.scon.project.admin.taskBoard.model.dao.TaskBoardMapper">


<resultMap id="taskBoardResultMap" type="com.scon.project.admin.taskBoard.model.dto.TaskBoardDTO">
	<id property="taskId" column="TASK_ID"/>
	<result property="taskTitle" column="TASK_TITLE"/>
	<result property="taskContent" column="TASK_CONTENT"/>
	<result property="taskDate" column="TASK_DATE"/>
	<result property="taskUpdate" column="TASK_UPDATE"/>
	<result property="taskDelete" column="TASK_DELETE"/>
	<result property="taskView" column="TASK_VIEW"/>
	<result property="memberId" column="MEMBER_ID"/>
	<result property="clsId" column="CLS_ID"/>
	<result property="memberName" column="MEMBER_NAME"/>
	
	<association property="fileId" column="FILE_ID"/>
</resultMap>

<resultMap id="fileResultMap" type="com.scon.project.member.model.dto.ProfileDTO">
		<id property="fileId" column="FILE_ID"/>
		<result property="fileOrginName" column="FILE_ORGNAME"/>
		<result property="fileSaveName" column="FILE_SAVENAME"/>
		<result property="filePath" column="FILE_PATH"/>
		<result property="fileType" column="FILE_TYPE"/>
		<result property="fileThumnailPathName" column="FILE_THUM_PATH"/>
		<result property="fileThumnailName" column="FILE_THUM.NAME"/>
</resultMap>

<resultMap id="taskFileResultMap" type="com.scon.project.admin.taskBoard.model.dto.TaskFile">
	<result property="taskId" column="TASK_ID" />
	<result property="fileID" column="FILE_ID"/>
</resultMap>

<!-- class (소영님) 
<resultMap id="classResultMap" type="com.scon.project.admin.Class.dto.ClassDTO">
		<id property="clsId" column="CLS_ID"/>
		<result property="clsName" column="CLS_NAME"/>
		<result property="clsStuNum" column="CLS_STUNUM"/>
		<result property="clsGrade" column="CLS_GRADE"/>
		<result property="clsPay" column="CLS_PAY"/>
		<result property="clsRoom" column="CLS_ROOM"/>
		<result property="clsStart" column="CLS_START"/>
		<result property="clsEnd" column="CLS_END"/>
		<result property="clsNote" column="CLS_NOTE"/>
		<result property="clsStatus" column="CLS_STATUS"/>
</resultMap> -->

	<!--  과제 게시판 목록 조회 -->
		<select id="findAllTask" resultMap="taskBoardResultMap">
			SELECT
				T.TASK_ID
			  , T.MEMBER_ID
			  , T.CLS_ID
			  , T.TASK_TITLE
			  , T.TASK_CONTENT
			  , T.TASK_DATE
			  , M.MEMBER_NAME
			FROM TB_TASK T
			JOIN TB_MEMBER M ON(T.MEMBER_ID = M.MEMBER_ID)
			WHERE T.CLS_ID = #{ clsId }
			AND T.TASK_DELETE = 'N'
		</select>

	 <!--  파일 업로드 전 -->
	<!--  <insert id="insert">
	 	INSERT 
	 		INTO TB_TASK
	 		(
	 		 TASK_ID
	       , MEMBER_ID
	       , CLS_ID
	       , TASK_TITLE
	       , TASK_CONTENT
	       , TASK_DATE
	       , TASK_UPDATE
	 		)
	 		VALUES
	 		(
	 		 SEQ_TASK_NO.NEXTVAL
	 	   , 
	 		)
	 </insert>-->

	<!-- 과제 게시판 게시글 입력 -->
	<insert id="insertTask">
		INSERT
			INTO TB_TASK
			(
				TASK_ID
			  , MEMBER_ID
			  , CLS_ID
			  , TASK_TITLE
			  , TASK_CONTENT
			  , TASK_DATE
			)
			VALUES
			(
				SEQ_TASK_NO.NEXTVAL
			  , #{ memberId }
			  , #{ clsId }
			  , #{ taskTitle }
			  , #{ taskContent }
			  , SYSDATE
			)
	</insert>

</mapper>